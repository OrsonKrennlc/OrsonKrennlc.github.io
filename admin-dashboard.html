<div class="editor-container">
    <form id="post-form">
        <input type="text" id="post-title" placeholder="标题" required>
        <div id="editor-toolbar">
            <button onclick="formatText('bold')">**加粗**</button>
            <button onclick="insertTable()">插入表格</button>
            <input type="file" id="image-upload" accept="image/*">
        </div>
        <textarea id="post-content" placeholder="请输入Markdown内容"></textarea>
        <button type="submit">发布</button>
    </form>
</div>

<script>
    // Markdown实时预览
    const editor = CodeMirror.fromTextArea(document.getElementById('post-content'), {
        mode: 'markdown',
        lineNumbers: true
    });

    // 图片上传处理
    document.getElementById('image-upload').addEventListener('change', (e) => {
        const file = e.target.files[0];
        const formData = new FormData();
        formData.append('image', file);

        // 使用Fetch上传到服务器
        fetch('/api/upload', {
            method: 'POST',
            body: formData
        }).then(response => response.json())
          .then(data => {
              const imgUrl = data.url;
              editor.replaceSelection(`![图片](${imgUrl})`);
          });
    });
</script>